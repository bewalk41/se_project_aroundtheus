!function(){"use strict";class e{constructor(e,t,s){let{name:n,link:r}=e;this._name=n,this._link=r,this._cardSelector=t,this._handleImageClick=s}_setEventListener(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".card__trash-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{"function"==typeof this._handleImageClick&&this._handleImageClick(this._link,this._name)}))}_handleLikeIcon(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}getView(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement.querySelector(".card__header").textContent=this._name;const e=this._cardElement.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._setEventListener(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputEls=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent="",e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}toggleButtonState(){this._toggleButtonState()}},s=class{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("mousedown",(e=>{e.target===this._popupElement&&this.close()}))}},n=class extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popupElement.querySelector(".modal__form"),this._inputList=Array.from(this._form.querySelectorAll(".modal__input"))}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._form.reset(),this.close()}))}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}},r=class extends s{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".modal__image"),this._captionElement=this._popupElement.querySelector(".modal__caption")}open(e){let{name:t,link:s}=e;this._imageElement.src=s,this._imageElement.alt=t,this._captionElement.textContent=t,super.open()}},o=class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,job:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=s}},i=class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}},a=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse).catch((e=>{throw console.error("Failed to fetch initial cards:",e),e}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse).catch((e=>{throw console.error("Failed to fetch user info:",e),e}))}setUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse).catch((e=>{throw console.error("Failed to update user info:",e),e}))}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse).catch((e=>{throw console.error("Failed to add card:",e),e}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"53409dbf-84c2-43f0-94a8-bcee506cb677","Content-Type":"application/json"}});const l={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};document.addEventListener("DOMContentLoaded",(()=>{const s=document.querySelector("#profile-edit-button"),c=document.querySelector("#add-card-button"),d=new o({nameSelector:".profile__name",jobSelector:".profile__description",avatarSelector:".profile__avatar"}),h=new t(l,document.querySelector("#profile-edit-modal .modal__form")),_=new t(l,document.querySelector("#add-card-modal .modal__form"));h.enableValidation(),_.enableValidation();const u=(e,t)=>{E.open({name:t,link:e})},m=new n("#profile-edit-modal",(e=>{a.setUserInfo({name:e.heading,about:e.description}).then((e=>{d.setUserInfo({name:e.name,job:e.about}),m.close()})).catch((e=>console.error("Failed to update profile:",e)))})),p=new n("#add-card-modal",(e=>{const t={name:e.heading,link:e.description};a.addCard(t).then((e=>{const t=b(e);f.addItem(t),p.close()})).catch((e=>console.error("Failed to add card:",e)))})),E=new r("#image-modal");function b(t){return new e(t,"#card-template",u).getView()}m.setEventListeners(),p.setEventListeners(),E.setEventListeners();const f=new i({items:[],renderer:e=>{const t=b(e);f.addItem(t)}},".cards__list");Promise.all([a.getUserInfo(),a.getInitialCards()]).then((e=>{let[t,s]=e;d.setUserInfo({name:t.name,job:t.about,avatar:t.avatar}),f.renderItems(s)})).catch((e=>console.error("Failed to load initial data:",e))),s.addEventListener("click",(()=>{const e=d.getUserInfo();m.setInputValues({heading:e.name,description:e.job}),m.open(),h.resetValidation()})),c.addEventListener("click",(()=>{p.open(),_.toggleButtonState()}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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M0QsTUFBTyxHQUNQQyxTQUFXb0QsSUFDVCxNQUFNRSxFQUFjQyxFQUFlSCxHQUNuQ0ksRUFBUWxELFFBQVFnRCxFQUFZLEdBR2hDLGdCQUlGckMsUUFBUTBDLElBQUksQ0FBQ1osRUFBQUEsY0FBbUJBLEVBQUFBLG9CQUM3QnpCLE1BQUtoSSxJQUF1QixJQUFyQnNLLEVBQVVDLEdBQU12SyxFQUN0QitJLEVBQVN6QyxZQUFZLENBQ25CbkcsS0FBTW1LLEVBQVNuSyxLQUNma0csSUFBS2lFLEVBQVM3QixNQUNkK0IsT0FBUUYsRUFBU0UsU0FFbkJOLEVBQVFwRCxZQUFZeUQsRUFBTSxJQUUzQnRDLE9BQU9DLEdBQVFDLFFBQVFDLE1BQU0sK0JBQWdDRixLQUVoRVcsRUFBa0JoSSxpQkFBaUIsU0FBUyxLQUMxQyxNQUFNeUosRUFBV3ZCLEVBQVMzQyxjQUMxQmtELEVBQWlCMUQsZUFBZSxDQUM5QjhELFFBQVNZLEVBQVNuSyxLQUNsQndKLFlBQWFXLEVBQVNqRSxNQUV4QmlELEVBQWlCN0UsT0FDakJ5RSxFQUFrQmhGLGlCQUFpQixJQUdyQzRFLEVBQWNqSSxpQkFBaUIsU0FBUyxLQUN0Q2dKLEVBQWFwRixPQUNiMkUsRUFBcUJqRixtQkFBbUIsR0FDeEMsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVyKCkge1xyXG4gICAgLy8gU2V0IGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgbGlrZSBidXR0b25cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIFNldCBldmVudCBsaXN0ZW5lciBmb3IgdGhlIGRlbGV0ZSBidXR0b25cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIFNldCBldmVudCBsaXN0ZW5lciBmb3IgdGhlIGNhcmQgaW1hZ2VcclxuICAgIGNvbnN0IGNhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9saW5rLCB0aGlzLl9uYW1lKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUljb24oKSB7XHJcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVEZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgLy8gQ2xvbmUgdGhlIGNhcmQgdGVtcGxhdGUgY29udGVudFxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIC8vIFNldCB0aGUgY2FyZCB0aXRsZVxyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFkZXJcIik7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIC8vIFNldCB0aGUgY2FyZCBpbWFnZSBzb3VyY2UgYW5kIGFsdCB0ZXh0XHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVyKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gb3B0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvcHRpb25zLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvckVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dEVscy5zb21lKChpbnB1dEVsKSA9PiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTsgLy8gUmVzZXQgdGhlIGZvcm0gaW5wdXRzIGFmdGVyIHN1Ym1pdHRpbmdcclxuICAgICAgdGhpcy5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgbW9kYWwgYWZ0ZXIgc3VibWl0dGluZ1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9jYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XHJcbiIsImNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBpbml0aWFsIGNhcmRzOlwiLCBlcnIpO1xyXG4gICAgICAgIHRocm93IGVycjtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm86XCIsIGVycik7XHJcbiAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSB1c2VyIGluZm86XCIsIGVycik7XHJcbiAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBhZGQgY2FyZDpcIiwgZXJyKTtcclxuICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNTM0MDlkYmYtODRjMi00M2YwLTk0YTgtYmNlZTUwNmNiNjc3XCIsIC8vIFZlcmlmeSB0aGlzIHRva2VuXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFwaTtcclxuIiwiLy8gdXRpbHMvY29uc3RhbnRzLmpzXHJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25PcHRpb25zID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IGFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHsgdmFsaWRhdGlvbk9wdGlvbnMgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWJ1dHRvblwiKTtcclxuXHJcbiAgY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICAgIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxuICB9KTtcclxuXHJcbiAgY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICAgIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWwgLm1vZGFsX19mb3JtXCIpXHJcbiAgKTtcclxuXHJcbiAgY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICAgIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbCAubW9kYWxfX2Zvcm1cIilcclxuICApO1xyXG5cclxuICBlZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuICBjb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKGxpbmssIG5hbWUpID0+IHtcclxuICAgIGltYWdlUG9wdXAub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gICAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgICAoZm9ybURhdGEpID0+IHtcclxuICAgICAgYXBpXHJcbiAgICAgICAgLnNldFVzZXJJbmZvKHtcclxuICAgICAgICAgIG5hbWU6IGZvcm1EYXRhLmhlYWRpbmcsXHJcbiAgICAgICAgICBhYm91dDogZm9ybURhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigodXBkYXRlZFVzZXJJbmZvKSA9PiB7XHJcbiAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICAgIG5hbWU6IHVwZGF0ZWRVc2VySW5mby5uYW1lLFxyXG4gICAgICAgICAgICBqb2I6IHVwZGF0ZWRVc2VySW5mby5hYm91dCxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdXBkYXRlIHByb2ZpbGU6XCIsIGVycikpO1xyXG4gICAgfVxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2FkZC1jYXJkLW1vZGFsXCIsIChmb3JtRGF0YSkgPT4ge1xyXG4gICAgY29uc3QgY2FyZERhdGEgPSB7IG5hbWU6IGZvcm1EYXRhLmhlYWRpbmcsIGxpbms6IGZvcm1EYXRhLmRlc2NyaXB0aW9uIH07XHJcbiAgICBhcGlcclxuICAgICAgLmFkZENhcmQoY2FyZERhdGEpXHJcbiAgICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChuZXdDYXJkKTtcclxuICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBhZGQgY2FyZDpcIiwgZXJyKSk7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XHJcblxyXG4gIHByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBhZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBpbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gIGZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChkYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIsIGhhbmRsZUltYWdlQ2xpY2spO1xyXG4gICAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAge1xyXG4gICAgICBpdGVtczogW10sXHJcbiAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcclxuICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIFwiLmNhcmRzX19saXN0XCJcclxuICApO1xyXG5cclxuICAvLyBMb2FkIHVzZXIgaW5mbyBhbmQgaW5pdGlhbCBjYXJkcyB0b2dldGhlclxyXG4gIFByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgICBqb2I6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxyXG4gICAgICB9KTtcclxuICAgICAgc2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBpbml0aWFsIGRhdGE6XCIsIGVycikpO1xyXG5cclxuICBwcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gICAgcHJvZmlsZUVkaXRQb3B1cC5zZXRJbnB1dFZhbHVlcyh7XHJcbiAgICAgIGhlYWRpbmc6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5qb2IsXHJcbiAgICB9KTtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xyXG4gICAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcblxyXG4gIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbiAgICBhZGRDYXJkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVyIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUljb24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImdldFZpZXciLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJ0ZXh0Q29udGVudCIsImNhcmRJbWFnZSIsInNyYyIsImFsdCIsIm9wdGlvbnMiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJfaW5wdXRFbHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0RWwiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJhZGQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9kaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwiX2ltYWdlRWxlbWVudCIsIl9jYXB0aW9uRWxlbWVudCIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYWRkQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ2YWxpZGF0aW9uT3B0aW9ucyIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsInVzZXJJbmZvIiwiVXNlckluZm8iLCJhdmF0YXJTZWxlY3RvciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiaW1hZ2VQb3B1cCIsInByb2ZpbGVFZGl0UG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybURhdGEiLCJhcGkiLCJoZWFkaW5nIiwiZGVzY3JpcHRpb24iLCJ1cGRhdGVkVXNlckluZm8iLCJhZGRDYXJkUG9wdXAiLCJjYXJkRGF0YSIsIm5ld0NhcmQiLCJjYXJkRWxlbWVudCIsImdldENhcmRFbGVtZW50Iiwic2VjdGlvbiIsIlBvcHVwV2l0aEltYWdlIiwiU2VjdGlvbiIsImFsbCIsInVzZXJEYXRhIiwiY2FyZHMiLCJhdmF0YXIiXSwic291cmNlUm9vdCI6IiJ9
!function(){"use strict";class e{constructor(e,t,s,n){let{name:r,link:o,_id:i}=e;this._name=r,this._link=o,this._id=i,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=n}_setEventListener(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".card__trash-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{"function"==typeof this._handleImageClick&&this._handleImageClick(this._link,this._name)}))}_handleLikeIcon(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteCard(){"function"==typeof this._handleDeleteClick&&this._handleDeleteClick(this._id,this._cardElement)}getView(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement.querySelector(".card__header").textContent=this._name;const e=this._cardElement.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._setEventListener(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputEls=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent="",e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}toggleButtonState(){this._toggleButtonState()}},s=class{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("mousedown",(e=>{e.target===this._popupElement&&this.close()}))}},n=class extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popupElement.querySelector(".modal__form"),this._inputList=this._form.querySelectorAll(".modal__input"),this._submitButton=this._form.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}},r=class extends s{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".modal__image"),this._captionElement=this._popupElement.querySelector(".modal__caption")}open(e){let{name:t,link:s}=e;this._imageElement.src=s,this._imageElement.alt=t,this._captionElement.textContent=t,super.open()}};class o extends s{constructor(e){super(e),this._confirmButton=this._popupElement.querySelector(".modal__button_confirm"),this._confirmButtonText=this._confirmButton.textContent}setConfirmationHandler(e){this._handleConfirm=e}open(e){super.open(),this._data=e}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this._handleConfirm&&this._handleConfirm(this._data)}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._confirmButton.textContent=e?t:this._confirmButtonText}}var i=class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:n}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(n)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,job:s,avatar:n}=e;t&&(this._nameElement.textContent=t),s&&(this._jobElement.textContent=s),n&&(this._avatarElement.src=n)}setUserAvatar(e){this._avatarElement.src=e}};class a{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s||[],this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const l=[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],c={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var h=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_handleError(e){throw console.error("API Error:",e),e}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse).catch(this._handleError)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse).catch(this._handleError)}setUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(this._checkResponse).catch(this._handleError)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(this._checkResponse).catch(this._handleError)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse).catch(this._handleError)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse).catch(this._handleError)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse).catch(this._handleError)}setUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(this._checkResponse).catch(this._handleError)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f2772a6b-ab7a-4d91-8e26-99a73e7be810","Content-Type":"application/json"}});document.addEventListener("DOMContentLoaded",(()=>{const s=document.querySelector("#profile-edit-button"),d=document.querySelector("#add-card-button"),_=document.querySelector(".profile__image-button"),u=new i({nameSelector:".profile__name",jobSelector:".profile__description",avatarSelector:".profile__image"}),m=new t(c,document.querySelector("#profile-edit-modal .modal__form")),p=new t(c,document.querySelector("#add-card-modal .modal__form"));m.enableValidation(),p.enableValidation();const E=(e,t)=>{v.open({name:t,link:e})},f=new n("#profile-edit-modal",(e=>{f.renderLoading(!0),h.setUserInfo({name:e.heading,about:e.description}).then((()=>{u.setUserInfo({name:e.heading,job:e.description}),f.close()})).catch((e=>console.error(e))).finally((()=>f.renderLoading(!1)))})),g=new n("#add-card-modal",(e=>{g.renderLoading(!0);const t={name:e.heading,link:e.description};h.addCard(t).then((e=>{const t=L(e);S.addItem(t),g.close()})).catch((e=>console.error(e))).finally((()=>g.renderLoading(!1)))})),v=new r("#image-modal"),b=new o("#confirm-popup");b.setEventListeners(),b.setConfirmationHandler((e=>{let{cardId:t,cardElement:s}=e;b.renderLoading(!0),h.deleteCard(t).then((()=>{s.remove(),b.close()})).catch((e=>console.error(e))).finally((()=>b.renderLoading(!1)))})),f.setEventListeners(),g.setEventListeners(),v.setEventListeners();const C=new n("#profile-popup",(e=>{C.renderLoading(!0),h.setUserAvatar({avatar:e.description}).then((e=>{u.setUserAvatar(e.avatar),C.close()})).catch((e=>console.error(e))).finally((()=>C.renderLoading(!1)))}));function L(t){return new e(t,"#card-template",E,((e,t)=>{b.open({cardId:e,cardElement:t})}),((e,t,s)=>{t?h.dislikeCard(e).then((e=>{s.setIsLiked(!1)})).catch((e=>console.error(e))):h.likeCard(e).then((e=>{s.setIsLiked(!0)})).catch((e=>console.error(e)))})).getView()}C.setEventListeners();const S=new a({items:l,renderer:e=>{const t=L(e);S.addItem(t)}},".cards__list");s.addEventListener("click",(()=>{const e=u.getUserInfo();f.setInputValues({heading:e.name,description:e.job}),f.open(),m.resetValidation()})),d.addEventListener("click",(()=>{g.open(),p.toggleButtonState()})),_.addEventListener("click",(()=>{C.open()})),h.getUserInfo().then((e=>{u.setUserInfo(e)})).catch((e=>console.error("Error fetching user info:",e))),h.getInitialCards().then((e=>{console.log("Initial Cards:",e),S.renderItems(e)})).catch((e=>console.error("Error fetching initial cards:",e)))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Rm5CLEVBQWtCeEosaUJBQWlCLFNBQVMsS0FDMUMsTUFBTXFMLEVBQVcxQixFQUFTcEQsY0FDMUIwRCxFQUFpQmxGLGVBQWUsQ0FDOUJzRixRQUFTZ0IsRUFBU2pNLEtBQ2xCbUwsWUFBYWMsRUFBUzdFLE1BRXhCeUQsRUFBaUJyRyxPQUNqQmlHLEVBQWtCeEcsaUJBQWlCLElBR3JDb0csRUFBY3pKLGlCQUFpQixTQUFTLEtBQ3RDeUssRUFBYTdHLE9BQ2JtRyxFQUFxQnpHLG1CQUFtQixJQUcxQ29HLEVBQW1CMUosaUJBQWlCLFNBQVMsS0FDM0NnTCxFQUFrQnBILE1BQU0sSUFHMUJ3RyxFQUFBQSxjQUVHekIsTUFBTTBDLElBQ0wxQixFQUFTakQsWUFBWTJFLEVBQVMsSUFFL0J6QyxPQUFPTCxHQUFRQyxRQUFRQyxNQUFNLDRCQUE2QkYsS0FFN0Q2QixFQUFBQSxrQkFFR3pCLE1BQU1sQixJQUNMZSxRQUFROEMsSUFBSSxpQkFBa0I3RCxHQUM5Qm9ELEVBQVF6RCxZQUFZSyxFQUFhLElBRWxDbUIsT0FBT0wsR0FBUUMsUUFBUUMsTUFBTSxnQ0FBaUNGLElBQUssRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHsgbmFtZSwgbGluaywgX2lkIH0sXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9pZCA9IF9pZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVyKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUljb24oKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgaWYgKHR5cGVvZiB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICBpZiAodHlwZW9mIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQsIHRoaXMuX2NhcmRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFkZXJcIik7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIGNhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXIoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gb3B0aW9ucy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBvcHRpb25zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IG9wdGlvbnMuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IG9wdGlvbnMuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IG9wdGlvbnMuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgZXJyb3JFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvckVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxzLnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9jYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19idXR0b25fY29uZmlybVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvblRleHQgPSB0aGlzLl9jb25maXJtQnV0dG9uLnRleHRDb250ZW50OyAvLyBTdG9yZSB0aGUgaW5pdGlhbCBidXR0b24gdGV4dFxyXG4gIH1cclxuXHJcbiAgc2V0Q29uZmlybWF0aW9uSGFuZGxlcihoYW5kbGVyKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVDb25maXJtID0gaGFuZGxlcjtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7IC8vIFN0b3JlIHRoZSBkYXRhIG5lZWRlZCBmb3IgY29uZmlybWF0aW9uXHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLl9oYW5kbGVDb25maXJtKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ29uZmlybSh0aGlzLl9kYXRhKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9jb25maXJtQnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IsIGF2YXRhciB9KSB7XHJcbiAgICBpZiAobmFtZSkge1xyXG4gICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB9XHJcbiAgICBpZiAoam9iKSB7XHJcbiAgICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XHJcbiAgICB9XHJcbiAgICBpZiAoYXZhdGFyKSB7XHJcbiAgICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXMgfHwgW107IC8vIEVuc3VyZSBpdGVtcyBpcyBhbiBhcnJheVxyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsIi8vIHV0aWxzL2NvbnN0YW50cy5qc1xyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uT3B0aW9ucyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFcnJvcihlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJBUEkgRXJyb3I6XCIsIGVycik7XHJcbiAgICB0aHJvdyBlcnI7XHJcbiAgfVxyXG5cclxuICAvLyAxLiBMb2FkaW5nIHVzZXIgaW5mb3JtYXRpb24gZnJvbSB0aGUgc2VydmVyXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gMi4gTG9hZGluZyBjYXJkcyBmcm9tIHRoZSBzZXJ2ZXJcclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gMy4gRWRpdGluZyB0aGUgcHJvZmlsZVxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAuLi50aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCh0aGlzLl9oYW5kbGVFcnJvcik7XHJcbiAgfVxyXG5cclxuICAvLyA0LiBBZGRpbmcgYSBuZXcgY2FyZFxyXG4gIGFkZENhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4udGhpcy5faGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gNi4gRGVsZXRpbmcgYSBjYXJkXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC5jYXRjaCh0aGlzLl9oYW5kbGVFcnJvcik7XHJcbiAgfVxyXG5cclxuICAvLyA3LiBBZGRpbmcgYW5kIHJlbW92aW5nIGxpa2VzXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gOC4gVXBkYXRpbmcgcHJvZmlsZSBwaWN0dXJlXHJcbiAgc2V0VXNlckF2YXRhcihkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIC4uLnRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICAgICAgLmNhdGNoKHRoaXMuX2hhbmRsZUVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImYyNzcyYTZiLWFiN2EtNGQ5MS04ZTI2LTk5YTczZTdiZTgxMFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhcGk7XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyB2YWxpZGF0aW9uT3B0aW9ucywgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiOyAvLyBJbXBvcnQgaW5pdGlhbCBjYXJkc1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjsgLy8gRW5zdXJlIHRoZSBDU1MgcGF0aCBpcyBjb3JyZWN0XHJcbmltcG9ydCBhcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7IC8vIEltcG9ydCB0aGUgYXBpIGluc3RhbmNlXHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcbiAgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbiAgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IHByb2ZpbGVJbWFnZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2UtYnV0dG9uXCIpO1xyXG5cclxuICBjb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICAgIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gICAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsIC8vIEFkZCB0aGUgYXZhdGFyIHNlbGVjdG9yXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgICB2YWxpZGF0aW9uT3B0aW9ucyxcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsIC5tb2RhbF9fZm9ybVwiKVxyXG4gICk7XHJcbiAgY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICAgIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbCAubW9kYWxfX2Zvcm1cIilcclxuICApO1xyXG5cclxuICBlZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuICBjb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKGxpbmssIG5hbWUpID0+IHtcclxuICAgIGltYWdlUG9wdXAub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gICAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgICAoZm9ybURhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZUVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICBhcGlcclxuICAgICAgICAuc2V0VXNlckluZm8oe1xyXG4gICAgICAgICAgbmFtZTogZm9ybURhdGEuaGVhZGluZyxcclxuICAgICAgICAgIGFib3V0OiBmb3JtRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICAgICAgbmFtZTogZm9ybURhdGEuaGVhZGluZyxcclxuICAgICAgICAgICAgam9iOiBmb3JtRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBwcm9maWxlRWRpdFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxuICAgIH1cclxuICApO1xyXG5cclxuICBjb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhZGQtY2FyZC1tb2RhbFwiLCAoZm9ybURhdGEpID0+IHtcclxuICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgY29uc3QgY2FyZERhdGEgPSB7IG5hbWU6IGZvcm1EYXRhLmhlYWRpbmcsIGxpbms6IGZvcm1EYXRhLmRlc2NyaXB0aW9uIH07XHJcbiAgICBhcGlcclxuICAgICAgLmFkZENhcmQoY2FyZERhdGEpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiBhZGRDYXJkUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSkpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xyXG5cclxuICBjb25zdCBjb25maXJtUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2NvbmZpcm0tcG9wdXBcIik7XHJcbiAgY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gIGNvbmZpcm1Qb3B1cC5zZXRDb25maXJtYXRpb25IYW5kbGVyKCh7IGNhcmRJZCwgY2FyZEVsZW1lbnQgfSkgPT4ge1xyXG4gICAgY29uZmlybVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgY29uZmlybVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IGNvbmZpcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XHJcbiAgfSk7XHJcblxyXG4gIHByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBhZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBpbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gIGNvbnN0IHVwZGF0ZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1wb3B1cFwiLCAoZm9ybURhdGEpID0+IHtcclxuICAgIHVwZGF0ZUF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLnNldFVzZXJBdmF0YXIoeyBhdmF0YXI6IGZvcm1EYXRhLmRlc2NyaXB0aW9uIH0pXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmF2YXRhcik7XHJcbiAgICAgICAgdXBkYXRlQXZhdGFyUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4gdXBkYXRlQXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSkpO1xyXG4gIH0pO1xyXG5cclxuICB1cGRhdGVBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICBmdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgICAgKGNhcmRJZCwgY2FyZEVsZW1lbnQpID0+IHtcclxuICAgICAgICBjb25maXJtUG9wdXAub3Blbih7IGNhcmRJZCwgY2FyZEVsZW1lbnQgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIChjYXJkSWQsIGlzTGlrZWQsIGNhcmQpID0+IHtcclxuICAgICAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5kaXNsaWtlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmQuc2V0SXNMaWtlZChmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmxpa2VDYXJkKGNhcmRJZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZC5zZXRJc0xpa2VkKHRydWUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICB7XHJcbiAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsIC8vIFVzZSB0aGUgaW5pdGlhbCBjYXJkcyBhcnJheVxyXG4gICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XHJcbiAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgKTtcclxuXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXAuc2V0SW5wdXRWYWx1ZXMoe1xyXG4gICAgICBoZWFkaW5nOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuam9iLFxyXG4gICAgfSk7XHJcbiAgICBwcm9maWxlRWRpdFBvcHVwLm9wZW4oKTtcclxuICAgIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpOyAvLyBSZXNldCB2YWxpZGF0aW9uIHdoZW4gb3BlbmluZyB0aGUgcHJvZmlsZSBlZGl0IGZvcm1cclxuICB9KTtcclxuXHJcbiAgYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICAgIGFkZENhcmRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vIERpc2FibGUgdGhlIHN1Ym1pdCBidXR0b24gd2hlbiBvcGVuaW5nIHRoZSBhZGQgY2FyZCBmb3JtXHJcbiAgfSk7XHJcblxyXG4gIHByb2ZpbGVJbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgdXBkYXRlQXZhdGFyUG9wdXAub3BlbigpO1xyXG4gIH0pO1xyXG5cclxuICBhcGlcclxuICAgIC5nZXRVc2VySW5mbygpXHJcbiAgICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnIpKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAgIC50aGVuKChpbml0aWFsQ2FyZHMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJJbml0aWFsIENhcmRzOlwiLCBpbml0aWFsQ2FyZHMpOyAvLyBMb2cgdGhlIGluaXRpYWwgY2FyZHMgZGF0YVxyXG4gICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpbml0aWFsIGNhcmRzOlwiLCBlcnIpKTtcclxufSk7XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwibmFtZSIsImxpbmsiLCJfaWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9zZXRFdmVudExpc3RlbmVyIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUljb24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImdldFZpZXciLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJ0ZXh0Q29udGVudCIsImNhcmRJbWFnZSIsInNyYyIsImFsdCIsIm9wdGlvbnMiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJfaW5wdXRFbHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0RWwiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJhZGQiLCJyZW1vdmUiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9kaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwicmVzZXQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfaW1hZ2VFbGVtZW50IiwiX2NhcHRpb25FbGVtZW50IiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiX2NvbmZpcm1CdXR0b24iLCJfY29uZmlybUJ1dHRvblRleHQiLCJzZXRDb25maXJtYXRpb25IYW5kbGVyIiwiaGFuZGxlciIsIl9oYW5kbGVDb25maXJtIiwiX2RhdGEiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwiYXZhdGFyIiwic2V0VXNlckluZm8iLCJfcmVmMiIsInNldFVzZXJBdmF0YXIiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaW5pdGlhbENhcmRzIiwidmFsaWRhdGlvbk9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfaGFuZGxlRXJyb3IiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJmZXRjaCIsInRoZW4iLCJjYXRjaCIsImdldEluaXRpYWxDYXJkcyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsInByb2ZpbGVJbWFnZUJ1dHRvbiIsInVzZXJJbmZvIiwiVXNlckluZm8iLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsImltYWdlUG9wdXAiLCJwcm9maWxlRWRpdFBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImZvcm1EYXRhIiwiYXBpIiwiaGVhZGluZyIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJmaW5hbGx5IiwiYWRkQ2FyZFBvcHVwIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImdldENhcmRFbGVtZW50Iiwic2VjdGlvbiIsIlBvcHVwV2l0aEltYWdlIiwiY29uZmlybVBvcHVwIiwidXBkYXRlQXZhdGFyUG9wdXAiLCJpc0xpa2VkIiwiY2FyZCIsInJlc3BvbnNlIiwic2V0SXNMaWtlZCIsInVzZXJEYXRhIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==